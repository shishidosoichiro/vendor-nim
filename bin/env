#!/usr/bin/env sh

# Exit, if return non-zero or use an undefined variable.
set -eu

# Restore the current directory, if exit.
pwd="$PWD"
trap "cd \"$pwd\"" EXIT

# cd workdir
scriptfile="$(realpath "$0")"
bin="$(dirname "$scriptfile")"
workdir="$(dirname "$bin")"
cd "$workdir"

# Variables
VERSION=${1:-0.19.2}

# Start
home="$(./bin/home $VERSION)"

## Nimble Directory
#NIMBLE_DIR="$home/profile/.nimble"
#echo "export NIMBLE_DIR=\"$NIMBLE_DIR\""
#mkdir -p "$NIMBLE_DIR"

# If set path already, delete it.
if echo "$PATH" | grep -q "$PWD"; then
  echo "export PATH=`echo \"$PATH\" | sed -e \"s|$PWD[^:]*:||g\"`"
fi

# Path
bin="$(./bin/bin $VERSION)"
echo "export PATH=\"$bin:$PATH\""
